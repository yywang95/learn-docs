# 性能优化

<!-- TOC -->

- [性能优化](#性能优化)
    - [使用css开启硬件加速](#使用css开启硬件加速)
            - [方法一：css 3D变换可以触发硬件加速](#方法一css-3d变换可以触发硬件加速)
            - [方法二：will-change](#方法二will-change)
    - [web服务压力测试](#web服务压力测试)
            - [方法一：autocannon](#方法一autocannon)

<!-- /TOC -->

## 使用css开启硬件加速

#### 方法一：css 3D变换可以触发硬件加速

一般使用translateZ，因为`不会改变任何元素样式`，而且会使当前dom单独在一个layer，`减少重绘`的可能

```css
.a {
    transform: translateZ(0);
}
```

#### 方法二：will-change

will-change为web开发者提供了一种`告知浏览器该元素会有哪些变化的方法`，这样浏览器可以在元素属性真正发生变化之前`提前做好对应的优化准备工作`。 这种优化可以将一部分复杂的计算工作提前准备好，使页面的反应更为快速灵敏。

```css
.a {
    will-change: transform;
}
```

> tips
> 1. **不要将will-change应用到太多元素上**：浏览器已经尽力去尝试优化一切可以优化的东西，有些优化如果和will-change结合，有可能会消耗很多机器资源，过度使用会导致页面响应缓慢或者消耗非常多的资源
> 2. **有节制地使用**：元素不在变化中时，如果还显示的声明了will-change，则表示目标对象会经常变化，浏览器会将优化工作保存的比以前更久，所以最佳实践是当元素变化之前和之后通过脚本来切换 will-change的值。
> 3. **不要过早应用will-change优化**：如果你的页面在性能方面没什么问题，则不要添加will-change属性来榨取一丁点的速度。will-change的设计初衷是`作为最后的优化手段`，用来尝试解决现有的性能问题。它不应该被用来预防性能问题。过度使用will-change会导致大量的内存占用，并会导致更复杂的渲染过程，因为浏览器会试图准备可能存在的变化过程。这会导致更严重的性能问题。
> 4. **给它足够的工作时间**：这个属性是用来让页面开发者告知浏览器哪些属性可能会变化的。然后浏览器可以选择在变化发生前提前去做一些优化工作。所以给浏览器一点时间去真正做这些优化工作是非常重要的。使用时需要尝试去找到一些方法提前一定时间获知元素可能发生的变化，然后为它加上will-change属性。

## web服务压力测试

#### 方法一：autocannon

1. 简介

autocannon是个node开发的压力测试工具

2. 安装

```shell
npm i autocannon -g
```

3. 使用

```shell
autocannon -c 100 -d 5 -p 10 http://127.0.0.1:8080
```

- -c 请求数
- -d 运行多久
- -p 链接数
